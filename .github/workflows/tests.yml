name: Tests
on: 
   push: 
     branches: [ backend ]
jobs: 
   init: 
     runs-on: ubuntu-latest
     services: 
       postgres: 
         image: postgres
         env:
          POSTGRES_PASSWORD: postgres
         ports:
          5432:5432
     strategy:
       matrix: 
         node-version: [ 18.x ]
     steps: 
        - uses: actions/checkout@v3
        - name: Setup Node.js environment
          uses: actions/setup-node@v3
          with: 
            node-version: ${{ matrix.node-version }}
        - name: Setup environment variables
          run: echo "DATABASE_URL=${{ secrets.DATABASE_URL }}" >> .env
        - name: Install dependencies
          run: npm install
        - name: Run tests
          run: npm run test 
        - name: Run end-to-end tests
          run: npm run test:e2e 